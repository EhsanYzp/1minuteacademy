{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://1minuteacademy.dev/schemas/block.schema.json",
  "title": "1MinuteAcademy Page Block",
  "type": "object",
  "oneOf": [
    {
      "title": "Hero Block",
      "type": "object",
      "additionalProperties": false,
      "required": ["type", "title"],
      "properties": {
        "type": { "const": "hero" },
        "title": { "type": "string", "minLength": 1 },
        "subtitle": { "type": "string" },
        "when": { "$ref": "#/$defs/when" }
      }
    },
    {
      "title": "Bullets Block",
      "type": "object",
      "additionalProperties": false,
      "required": ["type", "items"],
      "properties": {
        "type": { "const": "bullets" },
        "title": { "type": "string" },
        "items": {
          "type": "array",
          "minItems": 1,
          "items": { "type": "string", "minLength": 1 }
        },
        "when": { "$ref": "#/$defs/when" }
      }
    },
    {
      "title": "Info Block",
      "type": "object",
      "additionalProperties": false,
      "required": ["type", "text"],
      "properties": {
        "type": { "const": "info" },
        "text": { "type": "string", "minLength": 1 },
        "when": { "$ref": "#/$defs/when" }
      }
    },
    {
      "title": "Call To Action Block",
      "type": "object",
      "additionalProperties": false,
      "required": ["type", "label", "action"],
      "properties": {
        "type": { "const": "cta" },
        "label": { "type": "string", "minLength": 1 },
        "variant": { "type": "string", "enum": ["primary", "secondary"], "default": "primary" },
        "action": {
          "type": "object",
          "additionalProperties": false,
          "required": ["type"],
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "startLesson",
                "tryAgain",
                "openReview",
                "goToTopics",
                "goToUpgrade",
                "goToProfile",
                "goToLogin",
                "goToReview",
                "goToTopic"
              ]
            },
            "topicId": { "type": "string" }
          }
        },
        "when": { "$ref": "#/$defs/when" }
      }
    },
    {
      "title": "CTA Row Block",
      "type": "object",
      "additionalProperties": false,
      "required": ["type", "items"],
      "properties": {
        "type": { "const": "ctaRow" },
        "items": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": ["label", "action"],
            "properties": {
              "label": { "type": "string", "minLength": 1 },
              "variant": { "type": "string", "enum": ["primary", "secondary"], "default": "primary" },
              "action": {
                "type": "object",
                "additionalProperties": false,
                "required": ["type"],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "startLesson",
                      "tryAgain",
                      "openReview",
                      "goToTopics",
                      "goToUpgrade",
                      "goToProfile",
                      "goToLogin",
                      "goToReview",
                      "goToTopic"
                    ]
                  },
                  "topicId": { "type": "string" }
                }
              },
              "when": { "$ref": "#/$defs/when" }
            }
          }
        },
        "when": { "$ref": "#/$defs/when" }
      }
    },
    {
      "title": "Divider Block",
      "type": "object",
      "additionalProperties": false,
      "required": ["type"],
      "properties": {
        "type": { "const": "divider" },
        "when": { "$ref": "#/$defs/when" }
      }
    },
    {
      "title": "Rating Prompt Block",
      "type": "object",
      "additionalProperties": false,
      "required": ["type"],
      "properties": {
        "type": { "const": "ratingPrompt" },
        "title": { "type": "string" },
        "when": { "$ref": "#/$defs/when" }
      }
    },
    {
      "title": "Takeaways Block",
      "type": "object",
      "additionalProperties": false,
      "required": ["type", "points"],
      "properties": {
        "type": { "const": "takeaways" },
        "title": { "type": "string" },
        "points": {
          "type": "array",
          "minItems": 1,
          "items": { "type": "string", "minLength": 1 }
        },
        "when": { "$ref": "#/$defs/when" }
      }
    },
    {
      "title": "Lesson Completion Stats Block",
      "type": "object",
      "additionalProperties": false,
      "required": ["type"],
      "properties": {
        "type": { "const": "completionStats" },
        "when": { "$ref": "#/$defs/when" }
      }
    },
    {
      "title": "Completion Progress Save Block",
      "type": "object",
      "additionalProperties": false,
      "required": ["type"],
      "properties": {
        "type": { "const": "completionProgress" },
        "when": { "$ref": "#/$defs/when" }
      }
    },
    {
      "title": "Pro Perk Panel Block",
      "type": "object",
      "additionalProperties": false,
      "required": ["type"],
      "properties": {
        "type": { "const": "proPerkPanel" },
        "when": { "$ref": "#/$defs/when" }
      }
    },
    {
      "title": "OneMA Award Panel Block",
      "type": "object",
      "additionalProperties": false,
      "required": ["type"],
      "properties": {
        "type": { "const": "oneMaAwardPanel" },
        "when": { "$ref": "#/$defs/when" }
      }
    },
    {
      "title": "Review Lesson Block",
      "type": "object",
      "additionalProperties": false,
      "required": ["type"],
      "properties": {
        "type": { "const": "reviewLesson" },
        "when": { "$ref": "#/$defs/when" }
      }
    }
  ],
  "$defs": {
    "when": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "completed": { "type": "boolean" },
        "canStart": { "type": "boolean" },
        "canReview": { "type": "boolean" },
        "loggedIn": { "type": "boolean" },
        "tier": {
          "oneOf": [
            { "type": "string", "minLength": 1 },
            { "type": "array", "minItems": 1, "items": { "type": "string", "minLength": 1 } }
          ]
        }
      }
    }
  }
}
